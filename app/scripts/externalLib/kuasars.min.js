/*! kuasars-js - v0.0.1 - 2014-07-08 */!function(){if("undefined"!=typeof module&&module.exports)var a=module.exports||{};else var a=this.Kuasars||{};a.permissions={ALL:"ALL",ANONYMOUS:"ANONYMOUS",NONE:"NONE"},a.ACL=function(b){this.permissions=b?{admin:b.admin,rw:b.rw,read:b.read}:{admin:{user:[a.Core.currentUser||"NONE"],groups:[]},rw:{user:["NONE"],groups:[]},read:{user:["NONE"],groups:[]}},this.setAdminPermission=function(a){this.permissions.admin.user=Array.isArray(a)?a:[a]},this.setReadWritePermission=function(a){this.permissions.rw.user=Array.isArray(a)?a:[a]},this.setReadPermission=function(a){this.permissions.read.user=Array.isArray(a)?a:[a]}},"undefined"!=typeof module&&module.exports?module.exports=a:window.Kuasars=a}(),function(){if("undefined"!=typeof module&&module.exports)var a=module.exports||{};else var a=this.Kuasars||{};a.Apps={save:function(b,c){var d={method:"POST",endpoint:"/applications",body:b};a.Core.request(d,function(a,b){"function"==typeof c&&c(a,b)})},get:function(b,c){var d={method:"GET",endpoint:"/applications/"+b};a.Core.request(d,function(a,b){"function"==typeof c&&c(a,b)})},replace:function(b,c){var d={method:"PUT",endpoint:"/applications/"+b.id,body:b};a.Core.request(d,function(a,b){"function"==typeof c&&c(a,b)})},deleteApp:function(b,c){var d={method:"DELETE",endpoint:"/applications/"+b};a.Core.request(d,function(a,b){"function"==typeof c&&c(a,b)})},getStatus:function(b,c){var d=b.appId||a.Core.appId;if(b.secret){var e={method:"GET",endpoint:"/applications/"+d+"/status",secret:b.secret||""};a.Core.request(e,function(a,b){"function"==typeof c&&c(a,b)})}else"function"==typeof c&&c(!0,"Missing parameters")},getDeveloperApps:function(b,c){"undefined"!=typeof c||a.Core.batch||(c=b),b=b||{};var d=a.Core.getPaginationParams(b),e={method:"GET",endpoint:"/applications",qs:d};a.Core.request(e,function(a,b){"function"==typeof c&&c(a,b)})},resetSecretKey:function(b,c){var d={method:"DELETE",endpoint:"/applications/"+b+"/secretKey"};a.Core.request(d,function(a,b){"function"==typeof c&&c(a,b)})}},"undefined"!=typeof module&&module.exports?module.exports=a:window.Kuasars=a}(),function(){if("undefined"!=typeof module&&module.exports)var a=module.exports||{};else var a=this.Kuasars||{};a.Batch={start:function(){a.Core.batch=!0},stop:function(){a.Core.batch=!1},reset:function(){a.Core.batchBuffer=[]},request:function(b,c){if("undefined"==typeof c&&(c=b,b={}),a.Core.batch){var b={method:"PUT",endpoint:"/batch",appId:b.appId||a.Core.appId,secret:b.secret||"",body:a.Core.batchBuffer};a.Batch.stop(),a.Batch.reset(),a.Core.request(b,function(a,b){"function"==typeof c&&c(a,b)})}else"function"==typeof c&&c(!0,"Batch is not enabled. Please, call startBatch function to start recording requests")}},"undefined"!=typeof module&&module.exports?module.exports=a:window.Kuasars=a}(),function(){if("undefined"!=typeof module&&module.exports)var a=module.exports||{};else var a=this.Kuasars||{};a.Code={upload:function(b,c){if("undefined"!=typeof module&&module.exports)var d=require("form-data");var e=new d,f=b.file;if(f){e.append("file",f);var g={method:"POST",endpoint:"/hosted/code",appId:b.appId||a.Core.appId,secret:b.secret||"",multipart:!0,filesize:f.length,body:e};a.Core.request(g,function(a,b){"function"==typeof c&&c(a,b)})}else"function"==typeof c&&c(!0,"Missing file argument")},download:function(b,c){"undefined"!=typeof c||a.Core.batch||(c=b),b=b||{};var d={method:"GET",endpoint:"/hosted/code",appId:b.appId||a.Core.appId,secret:b.secret||"",body:{},arraybuffer:!0,headers:{Accept:"text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8"}};a.Core.request(d,function(a,b){"function"==typeof c&&c(a,b)})},deleteCode:function(b,c){"undefined"!=typeof c||a.Core.batch||(c=b),b=b||{};var d={method:"DELETE",endpoint:"/hosted/code",appId:b.appId||a.Core.appId,secret:b.secret||"",body:{}};a.Core.request(d,function(a,b){"function"==typeof c&&c(a,b)})},getFunctions:function(b,c){"undefined"!=typeof c||a.Core.batch||(c=b),b=b||{};var d={method:"GET",endpoint:"/hosted/code/availableFunctions",appId:b.appId||a.Core.appId,secret:b.secret||"",body:{},headers:{Accept:"application/json, text/plain, */*"}};a.Core.request(d,function(a,b){"function"==typeof c&&c(a,b)})},executeFunction:function(b,c){var d=b.appId||a.Core.appId;if(b.name){var e={name:b.name};b.parameters&&(e.parameters=b.parameters),b.wait&&(e.wait=b.wait);var f={method:"POST",endpoint:"/hosted/code/"+d,secret:b.secret||"",body:e};a.Core.request(f,function(a,b){"function"==typeof c&&c(a,b)})}else"function"==typeof c&&c(!0,"Missing name argument")},startServer:function(b,c){"undefined"!=typeof c||a.Core.batch||(c=b),b=b||{};var d={method:"POST",endpoint:"/hosted/code/server",appId:b.appId||a.Core.appId,secret:b.secret||"",body:{}};a.Core.request(d,function(a,b){"function"==typeof c&&c(a,b)})},stopServer:function(b,c){"undefined"!=typeof c||a.Core.batch||(c=b),b=b||{};var d={method:"DELETE",endpoint:"/hosted/code/server",appId:b.appId||a.Core.appId,secret:b.secret||"",body:{}};a.Core.request(d,function(a,b){"function"==typeof c&&c(a,b)})},getServerStatus:function(b,c){"undefined"!=typeof c||a.Core.batch||(c=b),b=b||{};var d={method:"GET",endpoint:"/hosted/code/server",appId:b.appId||a.Core.appId,secret:b.secret||"",body:{}};a.Core.request(d,function(a,b){"function"==typeof c&&c(a,b)})}},"undefined"!=typeof module&&module.exports?module.exports=a:window.Kuasars=a}(),function(){if("undefined"!=typeof module&&module.exports)var a=module.exports||{},b=require("xhr2");else var a=this.Kuasars||{},b=this.XMLHttpRequest;a.Core={debug:!0,appId:"000000000000000000000000",currentUser:"",environment:"PRE",requestTimeout:1e4,retryTimes:[2e3,5e3],retry:0,SDK_VERSION:"0.1",token:"",version:"v1",batch:!1,batchBuffer:[],init:function(a,b,c){this.environment=a.toUpperCase(),this.version=b,this.appId=c},initForDeveloper:function(a,b){this.environment=a.toUpperCase(),this.version=b,this.appId="000000000000000000000000"},initToTest:function(){this.appId="000000000000000000000000",this.version="v1"},getEndpoint:function(){switch(this.environment){case"DEV":return"http://api-dev.kuasars.com";case"PRE":return"https://api-pre.kuasars.com";case"PRO":return"https://api.kuasars.com";default:throw"Unknown environment"}},request:function(c,d){var e={method:"",endpoint:"",headers:{},body:{}},f=c.method||"GET",g=c.endpoint||"",h=c.body||{},i=c.qs||{},j=this.getEndpoint()+"/"+this.version+g,k=c.secret||this.secret||"",l=c.filesize||"",m=c.headers||{},n=c.arraybuffer||!1;"files"==g.substring(1,6)&&(j=j.replace("//api","//static")),this.secret=null,e.method=f;var o=this.encodeParams(i);o&&(j+=";"+o),e.endpoint=j,c.multipart||this.batch||c.file||(h=JSON.stringify(h)),e.body=h;var p=new b;p.open(f,j,!0),c.multipart||(p.setRequestHeader("Content-Type","application/json"),p.setRequestHeader("Accept","application/json"),p.setRequestHeader("Cache-Control","no-cache"),p.setRequestHeader("Pragma","no-cache"),e.headers["Content-Type"]="application/json",e.headers.Accept="application/json",e.headers["Cache-Control"]="no-cache",e.headers.Pragma="no-cache"),p.setRequestHeader("Kuasars-App-Id",c.appId||this.appId),e.headers["Kuasars-App-Id"]=c.appId||this.appId,this.token&&""!=this.token&&(p.setRequestHeader("Kuasars-Session-Token",this.token),e.headers["Kuasars-Session-Token"]=this.token),""!=k&&(p.setRequestHeader("Kuasars-Secret-Key",k),e.headers["Kuasars-Secret-Key"]=k),""!=l&&(p.setRequestHeader("Kuasars-HC-File-Size",l),e.headers["Kuasars-HC-File-Size"]=l),c.file&&(delete e.headers["Content-Type"],delete p.upload._request._headers["Content-Type"]);for(var q in m)p.setRequestHeader(q,m[q]),e.headers[q]=m[q];if(a.Core.debug&&(console.log("======REQUEST======"),console.log("METHOD:"+c.method),console.log("URL: "+j),c.body?(console.log("BODY:"),console.log(c.body)):console.log("BODY: {}"),console.log("HEADERS:"),console.log(e.headers)),n&&(p.responseType="arraybuffer"),this.batch)this.batchBuffer.push(e);else{p.onerror=function(b){var c=!0;clearTimeout(r),a.Core.debug&&(console.log("======RESPONSE======"),console.log("Error:"+c),console.log(b)),"function"==typeof d&&d(c,b)},p.onload=function(b){function c(a){return a.length<2?"0"+a:a}var e=!0;if(clearTimeout(r),n){var g=p.response;if(g)if("undefined"!=typeof module&&module.exports){for(var h=new Buffer(g.byteLength),i=new Uint8Array(g),j=0;j<h.length;++j)h[j]=i[j];b=h}else{for(var k=new Uint8Array(g),l="",j=0,m=k.length;m>j;++j)l+="%"+c(k[j].toString(16));b=l}}else if(500==p.status)b=p.responseText||"";else if(204==p.status)b="","HEAD"==f&&(b=JSON.parse(p.getResponseHeader("Kuasars-Count")));else if("HEAD"==f)b="";else try{b=JSON.parse(p.responseText)||""}catch(o){b=p.responseText}p.status>=200&&p.status<=399&&(e=!1),a.Core.debug&&(console.log("======RESPONSE======"),console.log("Error:"+e),console.log(n?b:p.responseText)),"function"==typeof d&&d(e,b)};var r=setTimeout(function(){"undefined"!=typeof module&&module.exports&&(c.multipart||p.abort());var b=a.Core.retryTimes[a.Core.retry++];"undefined"!=typeof b?(a.Core.pause(b),a.Core.request(c,d)):(a.Core.retry=0,d(!0,"API timeout"))},this.requestTimeout);if("undefined"!=typeof module&&module.exports)if(c.multipart){var s=require("http"),m=h.getHeaders();m["Kuasars-Secret-Key"]=k,m["Kuasars-App-Id"]=c.appId||this.appId,m["Kuasars-HC-File-Size"]=l;var t=s.request({method:f,host:this.getEndpoint().substring(7),path:"/"+this.version+g,headers:m});h.pipe(t),t.on("error",function(b){clearTimeout(r),a.Core.debug&&(console.log("======RESPONSE======"),console.log("Error:"+!0),console.log(b)),"function"==typeof d&&d(!0,b)}),t.on("response",function(b){var c=b.statusCode,e="";b.on("data",function(a){e+=a}),b.on("end",function(){clearTimeout(r);var b=!0;c>=200&&399>=c&&(b=!1);var f;try{f=JSON.parse(e)||""}catch(g){f=e}a.Core.debug&&(console.log("======RESPONSE======"),console.log("Error:"+b),console.log(f)),"function"==typeof d&&d(b,f)})})}else p.send(h);else p.send(h)}},currentTime:function(b){var c={method:"GET",endpoint:"/currentTime"};a.Core.request(c,function(a,c){"function"==typeof b&&b(a,c)})},getServerStatus:function(b){var c={method:"GET",endpoint:"/healthcheck"};a.Core.request(c,function(a,c){"function"==typeof b&&b(a,c)})},encodeParams:function(a){tail=[];var b=[];if(a instanceof Array)for(i in a)b=a[i],b instanceof Array&&b.length>1&&tail.push(b[0]+"="+encodeURIComponent(b[1]));else for(var c in a)if(a.hasOwnProperty(c)){var d=a[c];if(d instanceof Array)for(i in d)b=d[i],tail.push(c+"="+encodeURIComponent(b));else tail.push(c+"="+encodeURIComponent(d))}return tail.join(";")},getPaginationParams:function(a){var b={};return"pageIndex"in a&&(b.page_index=a.pageIndex),"pageSize"in a&&(b.page_size=a.pageSize),"orderField"in a&&(b.order_field=a.orderField),"order"in a&&(b.order=a.order),b},pause:function(a){for(a+=(new Date).getTime();new Date<a;);}},"undefined"!=typeof module&&module.exports?module.exports=a:window.Kuasars=a}(),function(){if("undefined"!=typeof module&&module.exports)var a=module.exports||{};else var a=this.Kuasars||{};a.Devices={query:function(b,c){"undefined"!=typeof c||a.Core.batch||(c=b),b=b||{};var d={method:"POST",endpoint:"/devices/query",appId:b.appId||a.Core.appId,secret:b.secret||""};if(b.query)if(b.query.where||b.query.fields||b.query.limit||b.query.skip||b.query.order||b.query.type)b.query.where=JSON.stringify(b.query.where);else{console.log("Warning: see documentation to update your queries with new parameters.");var e=a.Core.getPaginationParams(b);d.endpoint="/users/query",d.qs=e}else b.query={where:"{}"};d.body=b.query,a.Core.request(d,function(a,b){"function"==typeof c&&c(a,b)})},count:function(b,c){"undefined"!=typeof c||a.Core.batch||(c=b),b=b||{};var d={method:"POST",endpoint:"/devices/count",appId:b.appId||a.Core.appId,secret:b.secret||""};a.Core.request(d,function(a,b){"function"==typeof c&&c(a,b)})},get:function(b,c){var d=b.deviceId||"missing_deviceId",e={method:"GET",endpoint:"/devices/"+d,appId:b.appId||a.Core.appId,secret:b.secret||""};a.Core.request(e,function(a,b){"function"==typeof c&&c(a,b)})},save:function(b,c){var d=(b.userId||a.Core.currentUser,b.device||{}),e={method:"POST",endpoint:"/devices/",appId:b.appId||a.Core.appId,body:d};a.Core.request(e,function(a,b){"function"==typeof c&&c(a,b)})},deleteDevice:function(b,c){var d=b.deviceId||"missing_deviceId",e={method:"DELETE",endpoint:"/devices/"+d,appId:b.appId||a.Core.appId,secret:b.secret||""};a.Core.request(e,function(a,b){"function"==typeof c&&c(a,b)})}},"undefined"!=typeof module&&module.exports?module.exports=a:window.Kuasars=a}(),function(){if("undefined"!=typeof module&&module.exports)var a=module.exports||{};else var a=this.Kuasars||{};a.Emails={send:function(b,c){var d={method:"POST",endpoint:"/emails/send",appId:b.appId||a.Core.appId,secret:b.secret||"",body:b.email||{}};a.Core.request(d,function(a,b){"function"==typeof c&&c(a,b)})},getTemplates:function(b,c){"undefined"!=typeof c||a.Core.batch||(c=b),b=b||{};var d,e=b.type||"",f=b.language||"";d=b.type&&b.language?"/emails/"+e+"/"+f:"/emails";var g={method:"GET",endpoint:d,appId:b.appId||a.Core.appId,secret:b.secret||""};a.Core.request(g,function(a,b){"function"==typeof c&&c(a,b)})},saveTemplate:function(b,c){var d={method:"POST",endpoint:"/emails",appId:b.appId||a.Core.appId,secret:b.secret||"",body:b.template||{}};a.Core.request(d,function(a,b){"function"==typeof c&&c(a,b)})},getTemplate:function(b,c){var d={method:"GET",endpoint:"/emails/"+b.type+"/"+b.language,appId:b.appId||a.Core.appId,secret:b.secret||""};a.Core.request(d,function(a,b){"function"==typeof c&&c(a,b)})},deleteTemplate:function(b,c){var d={method:"DELETE",endpoint:"/emails/"+b.type+"/"+b.language,appId:b.appId||a.Core.appId,secret:b.secret||"",body:b.template||{}};a.Core.request(d,function(a,b){"function"==typeof c&&c(a,b)})},deleteType:function(b,c){var d={method:"DELETE",endpoint:"/emails/"+b.type,appId:b.appId||a.Core.appId,secret:b.secret||"",body:b.template||{}};a.Core.request(d,function(a,b){"function"==typeof c&&c(a,b)})}},"undefined"!=typeof module&&module.exports?module.exports=a:window.Kuasars=a}(),function(){if("undefined"!=typeof module&&module.exports)var a=module.exports||{};else var a=this.Kuasars||{};a.Entities={getTypes:function(b,c){"undefined"!=typeof c||a.Core.batch||(c=b),b=b||{};var d="";b.occ&&(d="-occ");var e={method:"GET",endpoint:"/entities"+d,appId:b.appId||a.Core.appId,secret:b.secret||""};a.Core.request(e,function(a,b){"function"==typeof c&&c(a,b)})},save:function(b,c){var d=b.type||"";if(""==d)"function"==typeof c&&c(!0,"Missing entity type");else{var e="";b.occ&&(e="-occ");var f={method:"POST",endpoint:"/entities"+e+"/"+d,appId:b.appId||a.Core.appId,body:b.entity||{},secret:b.secret||""};a.Core.request(f,function(a,b){"function"==typeof c&&c(a,b)})}},saveType:function(b,c){var d="";b.occ&&(d="-occ");var e={method:"POST",endpoint:"/entities"+d,appId:b.appId||a.Core.appId,body:b.entityType||{},secret:b.secret||""};a.Core.request(e,function(a,b){"function"==typeof c&&c(a,b)})},get:function(b,c){var d=b.type||"",e=b.entityId||"";if(""==d||""==e)"function"==typeof c&&c(!0,"Missing parameters");else{var f="";b.occ&&(f="-occ");var g={method:"GET",endpoint:"/entities"+f+"/"+d+"/"+e,appId:b.appId||a.Core.appId,secret:b.secret||""};a.Core.request(g,function(a,b){"function"==typeof c&&c(a,b)})}},getType:function(b,c){var d=b.type||"";if(""==d)"function"==typeof c&&c(!0,"Missing parameters");else{var e="";b.occ&&(e="-occ");var f={method:"GET",endpoint:"/entities"+e+"/"+d,appId:b.appId||a.Core.appId,secret:b.secret||""};a.Core.request(f,function(a,b){"function"==typeof c&&c(a,b)})}},getACL:function(b,c){var d=b.type||"",e=b.entityId||"";if(""==d||""==e)"function"==typeof c&&c(!0,"Missing parameters");else{var f="";b.occ&&(f="-occ");var g={method:"GET",endpoint:"/entities"+f+"/"+d+"/"+e+"/acl",appId:b.appId||a.Core.appId,secret:b.secret||""};a.Core.request(g,function(a,b){"function"==typeof c&&c(a,b)})}},replace:function(b,c){var d=b.type||"",e=b.entityId||"";if(""==d||""==e)"function"==typeof c&&c(!0,"Missing parameters");else{var f="";b.occ&&(f="-occ");var g={method:"PUT",endpoint:"/entities"+f+"/"+d+"/"+e,appId:b.appId||a.Core.appId,body:b.entity||{},secret:b.secret||""};a.Core.request(g,function(a,b){"function"==typeof c&&c(a,b)})}},replaceType:function(b,c){var d="",e={description:b.entityType.description||""};b.occ&&(d="-occ");var f={method:"PUT",endpoint:"/entities"+d+"/"+b.entityType.type,appId:b.appId||a.Core.appId,body:e,secret:b.secret||""};a.Core.request(f,function(a,b){"function"==typeof c&&c(a,b)})},replaceACL:function(b,c){var d=b.type||"",e=b.entityId||"";if(""==d||""==e)"function"==typeof c&&c(!0,"Missing parameters");else{var f="";b.occ&&(f="-occ");var g={method:"PUT",endpoint:"/entities"+f+"/"+d+"/"+e+"/acl",appId:b.appId||a.Core.appId,body:b.acl||{},secret:b.secret||""};a.Core.request(g,function(a,b){"function"==typeof c&&c(a,b)})}},count:function(b,c){var d=b.type||"";if(""==d)"function"==typeof c&&c(!0,"Missing parameters");else{var e="";b.occ&&(e="-occ");var f={method:"POST",endpoint:"/entities"+e+"/"+d+"/count",appId:b.appId||a.Core.appId,body:b.query||{},secret:b.secret||""};a.Core.request(f,function(a,b){"function"==typeof c&&c(a,b)})}},query:function(b,c){var d=b.type||"";if(""==d)"function"==typeof c&&c(!0,"Missing type");else{var e="";b.occ&&(e="-occ");var f={method:"POST",endpoint:"/entities"+e+"/"+d+"/queryTwo",appId:b.appId||a.Core.appId,secret:b.secret||""};if(b.query)if(b.query.where||b.query.fields||b.query.limit||b.query.skip||b.query.order||b.query.type)b.query.where=JSON.stringify(b.query.where);else{console.log("Warning: see documentation to update your queries with new parameters.");var g=a.Core.getPaginationParams(b);f.endpoint="/entities"+e+"/"+d+"/query",f.qs=g}else b.query={where:"{}"};f.body=b.query,a.Core.request(f,function(a,b){"function"==typeof c&&c(a,b)})}},deleteEntity:function(b,c){var d=b.type||"",e=b.entityId||"";if(""==d||""==e)"function"==typeof c&&c(!0,"Missing parameters");else{var f="",g="";b.occ&&(f="-occ",g="?version="+b.version);var h={method:"DELETE",endpoint:"/entities"+f+"/"+d+"/"+e+g,appId:b.appId||a.Core.appId,secret:b.secret||""};a.Core.request(h,function(a,b){"function"==typeof c&&c(a,b)})}},deleteType:function(b,c){var d=b.type||"";if(""==d)"function"==typeof c&&c(!0,"Missing entity type");else{var e="";b.occ&&(e="-occ");var f={method:"DELETE",endpoint:"/entities"+e+"/"+d,appId:b.appId||a.Core.appId,secret:b.secret||""};a.Core.request(f,function(a,b){"function"==typeof c&&c(a,b)})}},saveIndex:function(b,c){var d=b.type||"";if(""==d)"function"==typeof c&&c(!0,"Missing entity type");else{var e="";b.occ&&(e="-occ");var f={method:"POST",endpoint:"/entities"+e+"/"+d+"/index",appId:b.appId||a.Core.appId,body:b.index||{},secret:b.secret||""};a.Core.request(f,function(a,b){"function"==typeof c&&c(a,b)})}},deleteIndex:function(b,c){var d=b.type||"",e=b.name||"";if(""==d||""==e)"function"==typeof c&&c(!0,"Missing entity type");else{var f="";b.occ&&(f="-occ");var g={method:"DELETE",endpoint:"/entities"+f+"/"+d+"/index/"+e,appId:b.appId||a.Core.appId,secret:b.secret||""};a.Core.request(g,function(a,b){"function"==typeof c&&c(a,b)})}}},"undefined"!=typeof module&&module.exports?module.exports=a:window.Kuasars=a}(),function(){if("undefined"!=typeof module&&module.exports)var a=module.exports||{};else var a=this.Kuasars||{};a.Events={save:function(b,c){var d=b.event||{},e=b.eventsArray||[d],f={method:"POST",endpoint:"/events",appId:b.appId||a.Core.appId,secret:b.secret||"",body:e};a.Core.request(f,function(a,b){"function"==typeof c&&c(a,b)})}},"undefined"!=typeof module&&module.exports?module.exports=a:window.Kuasars=a}(),function(){if("undefined"!=typeof module&&module.exports)var a=module.exports||{};else var a=this.Kuasars||{};a.Files={initializeFileSystem:function(b,c){"undefined"!=typeof c||a.Core.batch||(c=b),b=b||{};var d=b.appId||a.Core.appId,e={method:"PUT",endpoint:"/files/"+d+"/init",secret:b.secret||""};a.Core.request(e,function(a,b){"function"==typeof c&&c(a,b)})},downloadFile:function(b,c){var d=b.path||"";if(""==d)"function"==typeof c&&c(!0,"Missing path argument");else{d=d.replace(new RegExp("^/+","g"),""),d=d.replace(new RegExp("/+$","g"),"");var e=b.appId||a.Core.appId,f={method:"GET",endpoint:"/files/"+e+"/"+d,secret:b.secret||"",body:{},arraybuffer:!0,file:!0};a.Core.request(f,function(a,b){"function"==typeof c&&c(a,b)})}},getFolderContent:function(b,c){var d=b.path||"";if(""==d)"function"==typeof c&&c(!0,"Missing path argument");else{d=d.replace(new RegExp("^/+","g"),""),d=d.replace(new RegExp("/+$","g"),"");var e=b.appId||a.Core.appId,f={method:"GET",endpoint:"/files/"+e+"/"+d+"/",secret:b.secret||""};a.Core.request(f,function(a,b){"function"==typeof c&&c(a,b)})}},uploadFile:function(b,c){var d=b.file.content,e=b.file.type,f=b.file.name||"",g=b.path||"";if(""==g)"function"==typeof c&&c(!0,"Missing path argument");else if(""==f)"function"==typeof c&&c(!0,"Missing file.name argument");else if(d){var h=b.appId||a.Core.appId;g=g.replace(new RegExp("^/+","g"),""),g=g.replace(new RegExp("/+$","g"),"");var i={method:"PUT",endpoint:"/files/"+h+"/"+g+"/"+f,secret:b.secret||"",body:d,file:!0,headers:{"Content-Type":e||"application/octet-stream"}};a.Core.request(i,function(a,b){"function"==typeof c&&c(a,b)})}else"function"==typeof c&&c(!0,"Missing file.content argument")},createFolder:function(b,c){var d=b.path||"";if(""==d)"function"==typeof c&&c(!0,"Missing folder argument");else{d=d.replace(new RegExp("^/+","g"),""),d=d.replace(new RegExp("/+$","g"),"");var e=b.appId||a.Core.appId,f={method:"PUT",endpoint:"/files/"+e+"/"+d+"/",secret:b.secret||""};a.Core.request(f,function(a,b){"function"==typeof c&&c(a,b)})}},deleteFile:function(b,c){var d=b.path||"";if(""==d)"function"==typeof c&&c(!0,"Missing path argument");else{d=d.replace(new RegExp("^/+","g"),"");var e=b.appId||a.Core.appId,f={method:"DELETE",endpoint:"/files/"+e+"/"+d,secret:b.secret||""};a.Core.request(f,function(a,b){"function"==typeof c&&c(a,b)})}},deleteFolder:function(b,c){var d=b.path||"";if(""==d)"function"==typeof c&&c(!0,"Missing folder argument");else{d=d.replace(new RegExp("^/+","g"),""),d=d.replace(new RegExp("/+$","g"),"");var e=b.appId||a.Core.appId,f={method:"DELETE",endpoint:"/files/"+e+"/"+d+"/",secret:b.secret||""};a.Core.request(f,function(a,b){"function"==typeof c&&c(a,b)})}},getACL:function(b,c){var d=b.path||"";if(""==d)"function"==typeof c&&c(!0,"Missing path argument");else{var e=b.appId||a.Core.appId;d=d.replace(new RegExp("^/+","g"),""),d=d.replace(new RegExp("/+$","g"),"");var f={method:"GET",endpoint:"/files/"+e+"/"+d+"/acl",secret:b.secret||""};a.Core.request(f,function(a,b){"function"==typeof c&&c(a,b)})}},replaceACL:function(b,c){var d=b.path||"";if(""==d)"function"==typeof c&&c(!0,"Missing path argument");else{var e=b.appId||a.Core.appId;d=d.replace(new RegExp("^/+","g"),""),d=d.replace(new RegExp("/+$","g"),"");var f={method:"PUT",endpoint:"/files/"+e+"/"+d+"/acl",secret:b.secret||"",body:b.acl||{}};a.Core.request(f,function(a,b){"function"==typeof c&&c(a,b)})}}},"undefined"!=typeof module&&module.exports?module.exports=a:window.Kuasars=a}(),function(){if("undefined"!=typeof module&&module.exports)var a=module.exports||{};else var a=this.Kuasars||{};a.Notifications={setAPNS:function(b,c){var d={method:"PUT",endpoint:"/notifications/conf/apns",appId:b.appId||a.Core.appId,secret:b.secret||"",body:b.apns||{}};a.Core.request(d,function(a,b){"function"==typeof c&&c(a,b)})},getAPNS:function(b,c){"undefined"!=typeof c||a.Core.batch||(c=b),b=b||{};var d={method:"GET",endpoint:"/notifications/conf/apns",appId:b.appId||a.Core.appId,secret:b.secret||""};a.Core.request(d,function(a,b){"function"==typeof c&&c(a,b)})},setGCM:function(b,c){var d={method:"PUT",endpoint:"/notifications/conf/gcm",appId:b.appId||a.Core.appId,secret:b.secret||"",body:b.gcm||{}};a.Core.request(d,function(a,b){"function"==typeof c&&c(a,b)})},getGCM:function(b,c){"undefined"!=typeof c||a.Core.batch||(c=b),b=b||{};var d={method:"GET",endpoint:"/notifications/conf/gcm",appId:b.appId||a.Core.appId,secret:b.secret||""};a.Core.request(d,function(a,b){"function"==typeof c&&c(a,b)})},send:function(b,c){var d={method:"PUT",endpoint:"/notifications/users",appId:b.appId||a.Core.appId,secret:b.secret||"",body:b.notification};a.Core.request(d,function(a,b){"function"==typeof c&&c(a,b)})},getErrors:function(b,c){"undefined"!=typeof c||a.Core.batch||(c=b),b=b||{};var d=b.errorId||"",e="";e=d?"/notifications/reports/"+d:"/notifications/reports";var f={method:"GET",endpoint:e,appId:b.appId||a.Core.appId,secret:b.secret||""};a.Core.request(f,function(a,b){"function"==typeof c&&c(a,b)})},getError:function(b,c){var d={method:"GET",endpoint:"/notifications/reports"+b.errorId,appId:b.appId||a.Core.appId,secret:b.secret||""};a.Core.request(d,function(a,b){"function"==typeof c&&c(a,b)})},deleteErrors:function(b,c){"undefined"!=typeof c||a.Core.batch||(c=b),b=b||{};var d={method:"DELETE",endpoint:"/notifications/reports",appId:b.appId||a.Core.appId,secret:b.secret||""};a.Core.request(d,function(a,b){"function"==typeof c&&c(a,b)})}},"undefined"!=typeof module&&module.exports?module.exports=a:window.Kuasars=a}(),function(){if("undefined"!=typeof module&&module.exports)var a=module.exports||{};else var a=this.Kuasars||{};a.toPromise=function(b){return function(){var c=a.Promise(),d=function(a,b){a?c.reject(b):c.fulfill(b)};return b.apply(this,[].slice.call(arguments,0).concat(d)),c}},a.Promise=function(){var a={PENDING:0,FULFILLED:1,REJECTED:2},b={state:a.PENDING,error:!1,changeState:function(b,c,d){return this.state==b?new Error("can't transition to same state: "+b):this.state==a.FULFILLED||this.state==a.REJECTED?new Error("can't transition from current state: "+b):b==a.FULFILLED&&arguments.length<2?new Error("transition to fulfilled must have a non null value"):b==a.REJECTED&&arguments.length<2?new Error("transition to rejected must have a non null reason"):(this.state=b,this.value=d,this.error=c,this.resolve(),this.state)},fulfill:function(b){this.changeState(a.FULFILLED,!1,b)},reject:function(b){this.changeState(a.REJECTED,!0,b)},then:function(a,c){this.cache=this.cache||[];var d=Object.create(b),e=this;return this.async(function(){e.cache.push({fulfill:a,reject:c,promise:d}),e.resolve()}),d},resolve:function(){if(this.state==a.PENDING)return!1;for(;this.cache&&this.cache.length;){var b=this.cache.shift(),c=this.state==a.FULFILLED?b.fulfill:b.reject;if("function"!=typeof c)b.promise.changeState(this.state,this.error,this.value);else try{var d=c(this.value);d&&"function"==typeof d.then?d.then(function(c){b.promise.changeState(a.FULFILLED,!1,c)},function(c){b.promise.changeState(a.REJECTED,!0,c)}):b.promise.changeState(a.FULFILLED,!1,d)}catch(e){b.promise.changeState(a.REJECTED,!1,e)}}},async:function(a){setTimeout(a,5)}};return Object.create(b)},"undefined"!=typeof module&&module.exports?module.exports=a:window.Kuasars=a}(),function(){if("undefined"!=typeof module&&module.exports)var a=module.exports||{};else var a=this.Kuasars||{};a.Tests={appWithSessionsSecret:"",appWithoutSessionsSecret:"",appWithSessionsId:"",appWithoutSessionsId:"",otherUserId:"",initDEV:function(){a.Core.environment="DEV",this.appWithSessionsId="52495c4ce4b0470bbfaead28",this.appWithoutSessionsId="52495c89e4b0470bbfaead2a",this.otherUserId="52495e85e4b0470bbfaead2f",this.appWithSessionsSecret="c385fba1-7578-4ceb-9622-31fbd0f2c3e6",this.appWithoutSessionsSecret="49e36f2d-0f81-4a90-a32d-4c199dcc32c0"},initPRE:function(){a.Core.environment="PRE",this.appWithSessionsId="52495c4ce4b0470bbfaead28",this.appWithoutSessionsId="52495c89e4b0470bbfaead2a",this.otherUserId="5266a4cae4b0fd6ea76f4e4c",this.appWithSessionsSecret="276be679-1776-48a5-bd8f-6f744364e335",this.appWithoutSessionsSecret="49e36f2d-0f81-4a90-a32d-4c199dcc32c0"},init:function(){this.initPRE()}},"undefined"!=typeof module&&module.exports?module.exports=a:window.Kuasars=a}(),function(){if("undefined"!=typeof module&&module.exports)var a=module.exports||{};else var a=this.Kuasars||{};a.Users={currentSessions:[],switchToSession:function(b){return b>=0&&b<this.currentSessions.length?(a.Core.currentUser=a.Users.currentSessions[b].user,a.Core.token=a.Users.currentSessions[b].token,a.Core.appId=a.Users.currentSessions[b].appId,!0):!1},setCurrentSession:function(b){a.Core.appId=b.appId,a.Core.currentUser=b.user,a.Core.token=b.token},getCurrentSession:function(){return{appId:a.Core.appId,user:a.Core.currentUser,token:a.Core.token}},addSession:function(a){var b=[];this.currentSessions.forEach(function(a){b.push(a.user)});var c=b.indexOf(a.user);-1!=c?this.currentSessions[c].token=a.token:this.currentSessions.push(a)},removeSession:function(a){var b=[];for(var c in this.currentSessions)b.push(c.token);var d=b.indexOf(a);this.currentSessions.splice(d,1)},query:function(b,c){"undefined"!=typeof c||a.Core.batch||(c=b),b=b||{};var d={method:"POST",endpoint:"/users/queryTwo",appId:b.appId||a.Core.appId,secret:b.secret||""};if(b.query)if(b.query.where||b.query.fields||b.query.limit||b.query.skip||b.query.order||b.query.type)b.query.where=JSON.stringify(b.query.where);else{console.log("Warning: see documentation to update your queries with new parameters.");var e=a.Core.getPaginationParams(b);d.endpoint="/users/query",d.qs=e}else b.query={where:"{}"};d.body=b.query,a.Core.request(d,function(a,b){"function"==typeof c&&c(a,b)})},count:function(b,c){"undefined"!=typeof c||a.Core.batch||(c=b),b=b||{};var d={method:"POST",endpoint:"/users/count",appId:b.appId||a.Core.appId,body:b.query||{},secret:b.secret||""};a.Core.request(d,function(a,b){"function"==typeof c&&c(a,b)})},queryByFacebook:function(b,c){var d={method:"POST",endpoint:"/users/auth/facebook/queryTwo",appId:b.appId||a.Core.appId,secret:b.secret||""};if(b.query)if(b.query.where||b.query.fields||b.query.limit||b.query.skip||b.query.order||b.query.type)b.query.where=b.query.where;else{console.log("Warning: see documentation to update your queries with new parameters.");var e=a.Core.getPaginationParams(b);d.endpoint="/users/auth/facebook/query",d.qs=e}else b.query={where:[]};d.body=b.query,a.Core.request(d,function(a,b){"function"==typeof c&&c(a,b)})},queryByEmail:function(b,c){var d={method:"POST",endpoint:"/users/auth/email/queryTwo",appId:b.appId||a.Core.appId,secret:b.secret||""};if(b.query)if(b.query.where||b.query.fields||b.query.limit||b.query.skip||b.query.order||b.query.type)b.query.where=b.query.where;else{console.log("Warning: see documentation to update your queries with new parameters.");var e=a.Core.getPaginationParams(b);d.endpoint="/users/auth/email/query",d.qs=e}else b.query={where:[]};d.body=b.query,a.Core.request(d,function(a,b){"function"==typeof c&&c(a,b)})},requestCodeToRegister:function(b,c){var d={method:"GET",endpoint:"/users/auth/email/token?email="+b.email+"&operation_type=register_new_email",appId:b.appId||a.Core.appId,secret:b.secret||""};a.Core.request(d,function(a,b){"function"==typeof c&&c(a,b)})},register:function(b,c){var d=JSON.parse(JSON.stringify(b.user))||{},e={method:"POST",endpoint:"/users",appId:b.appId||a.Core.appId,body:d,secret:b.secret||""};a.Core.request(e,function(a,b){"function"==typeof c&&c(a,b)})},loginByEmail:function(b,c){var d={method:"POST",endpoint:"/session/email",body:b};a.Core.request(d,function(b,d){b||(a.Core.currentUser=d.userId,a.Core.token=d.sessionToken,a.Users.addSession({user:d.userId,token:d.sessionToken,appId:d.appId})),"function"==typeof c&&c(b,d)})},loginByInternalToken:function(b,c){var d={method:"POST",endpoint:"/session/internalToken",body:b};a.Core.request(d,function(b,d){b||(a.Core.currentUser=d.userId,a.Core.token=d.sessionToken,a.Users.addSession({user:d.userId,token:d.sessionToken,appId:d.appId})),"function"==typeof c&&c(b,d)})},loginByFacebook:function(b,c){var d={method:"POST",endpoint:"/session/facebook",body:b};a.Core.request(d,function(b,d){b||(a.Core.currentUser=d.userId,a.Core.token=d.sessionToken,a.Users.addSession({user:d.userId,token:d.sessionToken,appId:d.appId})),"function"==typeof c&&c(b,d)
})},getSession:function(b,c){"undefined"==typeof c&&(c=b,b={});var d={method:"GET",endpoint:"/session",appId:b.appId||a.Core.appId,secret:b.secret||""};a.Core.request(d,function(b,d){b||(a.Core.currentUser=d.userId,a.Core.token=d.sessionToken,d.active?a.Users.addSession({user:d.userId,token:d.sessionToken,appId:d.appId}):a.Users.removeSession(d.sessionToken)),"function"==typeof c&&c(b,d)})},logout:function(b){var c={method:"DELETE",endpoint:"/session"};a.Core.request(c,function(c,d){c||(a.Users.removeSession(a.Core.token),a.Core.currentUser="",a.Core.token=""),"function"==typeof b&&b(c,d)})},get:function(b,c){"undefined"!=typeof c||a.Core.batch||(c=b),b=b||{};var d=b.userId||a.Core.currentUser,e={method:"GET",endpoint:"/users/"+d,appId:b.appId||a.Core.appId,secret:b.secret||""};a.Core.request(e,function(a,b){"function"==typeof c&&c(a,b)})},replace:function(b,c){var d=b.userId||a.Core.currentUser,e={method:"PUT",appId:b.appId||a.Core.appId,endpoint:"/users/"+d,body:b.user||{},secret:b.secret||""};a.Core.request(e,function(a,b){"function"==typeof c&&c(a,b)})},deleteUser:function(b,c){var d={method:"DELETE",endpoint:"/users/"+b.userId,appId:b.appId||a.Core.appId,secret:b.secret||""};a.Core.request(d,function(d,e){d||b.userId!=a.Core.currentUser||(a.Core.currentUser="",a.Core.token=""),"function"==typeof c&&c(d,e)})},requestCodeToResetPass:function(b,c){var d=b.email||"missing_mail",e={method:"GET",appId:b.appId||a.Core.appId,endpoint:"/users/auth/email/token?email="+d+"&operation_type=reset_password",secret:b.secret||""};a.Core.request(e,function(a,b){"function"==typeof c&&c(a,b)})},resetPassword:function(b,c){var d={method:"PUT",endpoint:"/users/auth/email/reset",appId:b.appId||a.Core.appId,body:b.authentication||{},secret:b.secret||""};a.Core.request(d,function(a,b){"function"==typeof c&&c(a,b)})},requestCodeToChangeEmail:function(b,c){var d=b.email||"missing_mail",e={method:"GET",appId:b.appId||a.Core.appId,endpoint:"/users/auth/email/token?email="+d+"&operation_type=change_email",secret:b.secret||""};a.Core.request(e,function(a,b){"function"==typeof c&&c(a,b)})},updateEmailCredentials:function(b,c){var d=b.userId||a.Core.currentUser,e={method:"PUT",appId:b.appId||a.Core.appId,endpoint:"/users/"+d+"/auth/email",body:b.authentication||{},secret:b.secret||""};a.Core.request(e,function(a,b){"function"==typeof c&&c(a,b)})},updateInternalToken:function(b,c){var d=b.userId||a.Core.currentUser,e={method:"PUT",appId:b.appId||a.Core.appId,endpoint:"/users/"+d+"/auth/internalToken",body:b.authentication||{},secret:b.secret||""};a.Core.request(e,function(a,b){"function"==typeof c&&c(a,b)})},updateFacebookAccount:function(b,c){var d=b.userId||a.Core.currentUser,e={method:"PUT",appId:b.appId||a.Core.appId,endpoint:"/users/"+d+"auth/facebook",body:b.authentication||{},secret:b.secret||""};a.Core.request(e,function(a,b){"function"==typeof c&&c(a,b)})},getPendingDevelopers:function(b,c){"undefined"!=typeof c||a.Core.batch||(c=b),b=b||{};var d={method:"POST",endpoint:"/users/query",appId:b.appId||a.Core.appId,body:{"management.approved":!1},secret:b.secret||""};a.Core.request(d,function(a,b){"function"==typeof c&&c(a,b)})},approveDeveloper:function(b,c){var d=b.userId||"",e={method:"PUT",endpoint:"/users/"+d+"/management",appId:b.appId||a.Core.appId,body:{approved:!0},secret:b.secret||""};a.Core.request(e,function(a,b){"function"==typeof c&&c(a,b)})}},"undefined"!=typeof module&&module.exports?module.exports=a:window.Kuasars=a}();